<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Practica B</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="css/reset.css" />
<link rel="stylesheet" type="text/css" href="css/register.css" />
<!-- Bootstrap CSS -->
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
	<!-- #Content -->
	
	<div id="content" class="container">
		<!--  <form action="#" method="get" onsubmit=""> -->
		<form action="servidor.php" method="post" id="registro">
			<fieldset>
				<legend>Datos personales</legend>
				
					<div class="flex-item">
					
					<div class="row">
					<div class="col-md-5">
						<div class="field-label">Nombre:</div> 
				<input type="text"
					name="nombre" id="registro_nombre" class="form-control" /> 
					<div class="invalid-feedback position-absolute">
					Por favor introduzca su nombre sin números.
				</div>
					</div>
					
					<div class="col-md-6">
						<div class="field-label">Apellido:</div>
						<input type="text"
					name="apellido" id="registro_apellidos" class="form-control" /> 
						<div class="invalid-feedback position-absolute">
					Por favor introduzca sus apellidos sin números.
				</div>
				</div>
				</div>
					<div class="row">
					<div class="col-md-5">
						<div class="field-label">Fecha nacimiento</div>
						<input type="text" name="fecha" id="registro-fecha" class="form-control"/> <!--  placeholder="dd/mm/yyyy" -->
						<div class="invalid-feedback position-absolute">
					Por favor introduzca su fecha de nacimiento en el formato válido.
				</div>
					</div>
					</div>
				
				
					<div class="row mt-3" id="registro_genero">
						<label for="registro_genero">Genero</label><br>
						<div class="form-check col-md-3 offset-md-1">
							<input class="form-check-input" type="radio" name="genero" id="registro_genero_hombre" value="H" >
							<label class="form-check-label" for="registro_genero_hombre"> Hombre</label>
						</div>
						<div class="form-check col-md-3">
							<input class="form-check-input " type="radio" name="genero" id="registro_genero_mujer" value="M" >
							<label class="form-check-label" for="registro_genero_mujer"> Mujer</label>
							<div class="invalid-feedback position-absolute">
					 			Por favor introduzca su genero.
							</div>
						</div>
						<div class="form-check col-md-3">
							<input class="form-check-input" type="radio" name="genero" id="registro_genero_otros" value="X" >
							<label class="form-check-label" for="registro_genero_otros"> Otros</label>
						</div>
					</div>
				
			
			
				</div>
			</fieldset>
			
			<fieldset>
			<div class="flex-item">
				<legend>Datos de contacto</legend>
				<div class="row">
					<div class="col-md-5">
						<div class="field-label">Email</div>
						<input type="text" name="email" class="form-control" id="registro_mail" />
						<div class="invalid-feedback position-absolute">
					Por favor introduzca un mail en el formato correcto.
				</div>
					</div>
					<div class="col-md-6">
						<div class="field-label">Telefono</div>
						<input type="text" name="telefono" class="form-control" id="registro_telefono" />
							<div class="invalid-feedback position-absolute">
					Por favor introduzca un telefono en el formato correcto.
				</div>
				</div>
				</div>
				<div class="row">
					
					<div class="col-md-5">
						<div class="field-label">Pagina personal</div>
						<input type="text" name="ppersonal" class="form-control" id="registro_pagina" />
							<div class="invalid-feedback position-absolute">
					Por favor introduzca una URL en el formato correcto.
				</div>
					</div>
				</div>
</div>
			</fieldset>
			
			<fieldset>
			<div class="row">
				<legend>Conocimientos</legend>
	  		<!--	<div class="conocimientos-flex-box row">  -->
					<div class="col-md-4 offset-md-1">
						<div class="field-label">Lenguajes</div>
						<select multiple id="lista" name="lista" size="7" id="registro_lenguajes" class="form-control">
							<option value="Php">Php</option>
							<option value="Phyton">Phyton</option>
							<option value="Java">Java</option>
							<option value="Jquery">JQuery</option>
							<option value=".NET">.NET</option>
						</select>
						<div class="invalid-feedback position-absolute">
					Por favor mueva por lo menos un lenguaje a la casilla de la derecha
				</div>
					</div>
					<div class="col-md-1 mt-5 pt-4">
						
							<button id="btn1" type="button" value=">"  onclick="seleccion(this,'lista','programacion');" class="btn btn-light border border-dark m-2" >&gt;</button>
                  <button id="btn2" type="button" value=">>" onclick="seleccion(this,'lista','programacion');" class="btn btn-light border border-dark m-2" >&gt;&gt;</button>
                  <button id="btn3" type="button" value="<"  onclick="seleccion(this,'lista','programacion');" class="btn btn-light border border-dark m-2"  >&lt;</button>
                  <button id="btn4" type="button" value="<<" onclick="seleccion(this,'lista','programacion');" class="btn btn-light border border-dark m-2" >&lt;&lt;</button>
						</div>

				<!--	</div> -->
					<div class="col-md-4">
						<div class="field-label">Lenguajes</div>
						<select multiple id="programacion" name="programacion[]" size="7" class="form-control">
						
						  
						</select>
						<div class="invalid-feedback position-absolute">
					Por favor introduzca por lo menos un lenguaje en la casilla de la derecha.
				</div>
					</div>
				</div>
</div>
			</fieldset>
			<fieldset>
				<div class="submit-flex-box">
					<div class="flex-item">
						<button class="btn btn-primary offset-lg-1 offset md-1" id="registro_enviar">Enviar datos</button>
					</div>
				</div>
			</fieldset>
		</form>
	</div>
	<script>

	function seleccion(objButton, idorigen, iddesti) {
		
		var objLlistaOrigen = document.getElementById(idorigen);
		var objLlistaDesti = document.getElementById(iddesti);
		//var opcionsseleccionades = $("#"+idorigen).val();
		//console.log(opcionsseleccionades);
		switch(objButton.value) {
		  case ">":
				for (var i=0; i<objLlistaOrigen.options.length; i++){
					if (objLlistaOrigen.options[i].selected == true) {
						document.getElementById(iddesti).appendChild(objLlistaOrigen.options[i]);
						i--;
					}
				}
		    break;
		  case ">>":
		  		for(var i=0; i<objLlistaOrigen.options.length; i++) {
		  			document.getElementById(iddesti).appendChild(objLlistaOrigen.options[i]);
		  			i--;
		  		}
		  break;
		  case "<":
				for (var i=0; i<objLlistaDesti.options.length; i++){
					if (objLlistaDesti.options[i].selected == true) {
						document.getElementById(idorigen).appendChild(objLlistaDesti.options[i]);
						i--;
					}
				}
		    break;
		  case "<<":
		  		for(var i=0; i<objLlistaDesti.options.length; i++) {
		  			document.getElementById(idorigen).appendChild(objLlistaDesti.options[i]);
		  			i--;
		  		}
		  break;
		}
		

		
		
	}
	
	
	/* 	function seleccion(boto) {
			

			if (boto.value == ">") {
		
				var opcions = $('#lista').val();
				for (var i = 0; i < opcions.length; i++) {
					document.getElementById("programacion").innerHTML += "<option value=\""+opcions[i]+"\">"
							+ opcions[i] + "</option>";
					for (var j = 0; j < document.getElementById('lista').options.length; j++) {
						console.log(document.getElementById("lista").options[j].value);
						if (document.getElementById("lista").options[j].value == opcions[i]) {
							document.getElementById("lista").options[j].remove();
						}
					}
				}
			} else if (boto.value == ">>") {
				for (var i = 0; i < document.getElementById('lista').options.length; i++) {
					document.getElementById("programacion").innerHTML += "<option value=\""
							+ document.getElementById('lista').options[i].value
							+ "\">"
							+ document.getElementById('lista').options[i].innerHTML
							+ "</option>";

				}
				document.getElementById("lista").innerHTML = "";
			} else if (boto.value == "<") {
				var opcionsmenys = $('#programacion').val();
				for (var i = 0; i < opcionsmenys.length; i++) {
					document.getElementById("lista").innerHTML += "<option value=\""+opcionsmenys[i]+"\">"
							+ opcionsmenys[i] + "</option>";
					for (var j = 0; j < document.getElementById('programacion').options.length; j++) {
						
						if (document.getElementById("programacion").options[j].value == opcionsmenys[i]) {
							document.getElementById("programacion").options[j]
									.remove();
						}
					}
				}
			} else {
				for (var i = 0; i < document.getElementById('programacion').options.length; i++) {
					document.getElementById("lista").innerHTML += "<option value=\""
							+ document.getElementById('programacion').options[i].value
							+ "\">"
							+ document.getElementById('programacion').options[i].innerHTML
							+ "</option>";
			}
				document.getElementById("programacion").innerHTML = "";
		

		}
		} */
		
		
		document.getElementById("registro_nombre").onblur=function(){
			this.form.nombre.value = this.form.nombre.value.trim();
			var string = this.form.nombre.value;
			var pattern = /\d/g;
			if( pattern.test(string) || string=="" ){
				this.form.nombre.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.nombre.className+=" is-valid";
			}
		}
		
		document.getElementById("registro_apellidos").onblur=function(){
			this.form.apellido.value = this.form.apellido.value.trim();
			var string2 = this.form.apellido.value;
			var pattern2 = /\d/g;
			if( pattern2.test(string2) || string2=="" ){
				this.form.apellido.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.apellido.className+=" is-valid";
			}
		}
		
		document.getElementById("registro-fecha").onblur=function(){
			this.form.fecha.value = this.form.fecha.value.trim();
			var string3 = this.form.fecha.value;
			var pattern3 = /(([0-2][0-9])|(3[01]))\/((0[1-9])|(1[0-2]))\/[12]\d{3}/g;
			if( (pattern3.test(string3)==false) || (string3=="") ){
				this.form.fecha.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.fecha.className+=" is-valid";
			}
		}
		
		document.getElementById("registro_genero_hombre").onblur=function(){
		if(this.form.genero.value==''){
			this.form.genero.forEach(function(item){
				item.className+=' is-invalid';
			});
			totOk=false;
		} else {
			this.form.genero.forEach(function(item){
				item.className+=' is-valid';
			});
		}
		}
		
		document.getElementById("registro_mail").onblur=function(){
			this.form.email.value = this.form.email.value.trim();
			var string4 = this.form.email.value;
			var pattern4 = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
			if(string4=='' || (pattern4.test(string4)==false)){
				this.form.email.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.email.className+=" is-valid";
			}
		}
		document.getElementById("registro_telefono").onblur=function(){
			this.form.telefono.value = this.form.telefono.value.trim();
			var string5 = this.form.telefono.value;
			//var pattern5 = /((\+[0-9]{2}\s)|(0{2}[0-9]{2}\s))[0-9]{9}/;
			var pattern5 = /((\+\d*)|00\d{2})?(\d){9}$/;
			if(string5=='' || (pattern5.test(string5)==false)){
				this.form.telefono.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.telefono.className+=" is-valid";
			}
		}
		document.getElementById("registro_pagina").onblur=function(){
			this.form.ppersonal.value = this.form.ppersonal.value.trim();
			var string6 = this.form.ppersonal.value;
			var pattern6 = /(http\:\/\/|https\:\/\/)\w+(\/)?(\w+)?/;
			if(string6=='' || (pattern6.test(string6)==false)){
				this.form.ppersonal.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.ppersonal.className+=" is-valid";
			}
		}
		document.getElementById("programacion").onblur=function(){
			if (this.form["programacion[]"].options.length==0) {
				this.form.programacion.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.programacion.className+=" is-valid";
			}
		}
		
		
		
		
		
		
		
		document.getElementById("registro_enviar").onclick=function(evt){
			// capturar event i parar-lo
			evt.preventDefault();
			// var totOk control d'enviament
			var totOk=true;
			// --- netejar classes 'is-invalid' i 'is-valid'
			this.form.querySelectorAll("*").forEach(function(item){
			item.className=item.className.replace(/(is-valid|is-invalid)/g,'');
		});
			
			// ---nombre ---
			
			this.form.nombre.value = this.form.nombre.value.trim();
			var string = this.form.nombre.value;
			var pattern = /\d/g;
			if( pattern.test(string) || string=="" ){
				this.form.nombre.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.nombre.className+=" is-valid";
			}
			
			// ---apellido ---
			
			this.form.apellido.value = this.form.apellido.value.trim();
			var string2 = this.form.apellido.value;
			var pattern2 = /\d/g;
			if( pattern2.test(string2) || string2=="" ){
				this.form.apellido.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.apellido.className+=" is-valid";
			}
			
			// ---fecha ---
			
			this.form.fecha.value = this.form.fecha.value.trim();
			var string3 = this.form.fecha.value;
			var pattern3 = /(([0-2][0-9])|(3[01]))\/((0[1-9])|(1[0-2]))\/[12]\d{3}/g;
			if( (pattern3.test(string3)==false) || (string3=="") ){
				this.form.fecha.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.fecha.className+=" is-valid";
			}
			
			// --- genero ----
			if(this.form.genero.value==''){
				this.form.genero.forEach(function(item){
					item.className+=' is-invalid';
				});
				totOk=false;
			} else {
				this.form.genero.forEach(function(item){
					item.className+=' is-valid';
				});
			}
			//---email---
			this.form.email.value = this.form.email.value.trim();
			var string4 = this.form.email.value;
			var pattern4 = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
			if(string4=='' || (pattern4.test(string4)==false)){
				this.form.email.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.email.className+=" is-valid";
			}
			
			//---telefono---
			this.form.telefono.value = this.form.telefono.value.trim();
			var string5 = this.form.telefono.value;
			//var pattern5 = /((\+[0-9]{2}\s)|(0{2}[0-9]{2}\s))[0-9]{9}/;
			var pattern5 = /((\+\d*)|00\d{2})?(\d){9}$/;
			if(string5=='' || (pattern5.test(string5)==false)){
				this.form.telefono.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.telefono.className+=" is-valid";
			}
			
			//---pagina---
			this.form.ppersonal.value = this.form.ppersonal.value.trim();
			var string6 = this.form.ppersonal.value;
			var pattern6 = /(http\:\/\/|https\:\/\/)\w+(\/)?(\w+)?/;
			if(string6=='' || (pattern6.test(string6)==false)){
				this.form.ppersonal.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.ppersonal.className+=" is-valid";
			}
			
			//-----lenguajes programacion----
			//if (this.form.programacion.value=='') {
				
			if	(this.form["programacion[]"].options.length==0) {
				this.form.programacion.className+=" is-invalid";
				totOk= false;
			} else {
				this.form.programacion.className+=" is-valid";
			}
			
			// ------------------------- Password -----------------------------------
		//	var passwordString=this.form.password.value;

		//	var passwordPattern=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}$/g; // Format Password

		//	if( !passwordPattern.test(passwordString) ){
			// ------------- Afegim la class 'is-invalid' a l'element
		//	this.form.password.className+=" is-invalid ";
		//	totOk=false;
		//	}else{
			// ------------- Afegim la class 'is-valid' a l'element ---------------
		//	this.form.password.className+=" is-valid ";
			//}
		//	
			
			
			// ------------------------ Comentarios ---------------------------------
		//	if(this.form.comentarios.value=="" ||this.form.comentarios.value.length>50 ){
			// ------------- Afegim la class 'is-invalid' a l'element
		//	this.form.comentarios.className+=" is-invalid ";
		//	totOk=false;
		//	}else{
			// ------------- Afegim la class 'is-valid' a l'element ---------------
		//	this.form.comentarios.className+=" is-valid ";
		//	}
			
			
			//----checkbox---
			//if (! this.form.condiciones.checked) {
			///	this.form.condiciones.className+=" is-invalid";
			//	totOk= false;
			//} else {
		//		this.form.condiciones.className+=" is-valid";
			//}
			
			
			if(totOk==true){
				this.form.submit(); //Disparar l'event submit del form al que pertany el button (this.form)
				// o be enviar les dades via AJAX
			}
			
		}
		
	</script>
</body>
</html>